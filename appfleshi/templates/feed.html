{% extends "homepage.html" %}

{% block body %}
<div class="container mt-4">
    <h1 class="text-center mb-4">Feed de Fotos</h1>

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
        <div class="container-fluid">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item mx-3">
                    <a href="{{ url_for('profile', user_id=current_user.id) }}" class="nav-link">
                        Perfil
                    </a>
                </li>
                <li class="nav-item mx-3">
                    <a href="{{ url_for('logout') }}" class="nav-link">
                        Sair
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="row">
        {% for photo in photos %}
            <div class="col-12 mb-4">
                <div class="card shadow-lg">
                    <img
                        src="{{ url_for('static', filename='posts_photos/' + photo.file_name) }}"
                        class="card-img-top"
                        style="max-height: 380px; object-fit: cover;"
                    >

                    <div class="card-body">
                        <p class="text-muted">
                            {{ photo.timestamp.strftime('%d/%m/%Y %H:%M') }}
                        </p>

                        <p><strong>{{ photo_likes[photo.id] }}</strong> curtidas</p>

                        <form action="{{ url_for('like', photo_id=photo.id) }}" method="POST" class="mb-2">
                            <button type="submit" class="btn btn-outline-success w-100">
                                {% if photo.id in liked_photos %}
                                    üëé Descurtir
                                {% else %}
                                    ‚ù§Ô∏è Curtir
                                {% endif %}
                            </button>
                        </form>

                        <div class="mb-3">
                            {% for comment in photo.comments %}
                                <p>
                                    <strong>{{ comment.user.username }}:</strong>
                                    {{ comment.content }}
                                </p>
                            {% endfor %}
                        </div>

                        <form method="POST" action="{{ url_for('comment', photo_id=photo.id) }}">
                            {{ form.hidden_tag() }}
                            {{ form.content(class="form-control mb-2", placeholder="Digite seu coment√°rio") }}
                            <button type="submit" class="btn btn-outline-success w-100">
                                Comentar
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}